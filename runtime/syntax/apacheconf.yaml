filetype: apacheconf

detect:
    filename: "httpd\\.conf|mime\\.types|vhosts\\.d\\\\*|\\.htaccess"

rules:
    - identifier: "(Accept(Mutex|PathInfo)|AccessFileName|Action|AddAlt|AddAltByEncoding|AddAltByType|AddCharset|AddDefaultCharset|AddDescription|AddEncoding)"
    - identifier: "(AddHandler|AddIcon|AddIconByEncoding|AddIconByType|AddInputFilter|AddLanguage|AddModuleInfo|AddOutputFilter|AddOutputFilterByType|AddType|Alias|AliasMatch)"
    - identifier: "(Allow(CONNECT|EncodedSlashes|Override)?|Anonymous(_(Authoritative|(Log|MustGive|Verify)Email|NoUserID))?|AssignUserID)"
    - identifier: "(AuthAuthoritative|AuthDBMAuthoritative|AuthDBMGroupFile|AuthDBMType|AuthDBMUserFile|AuthDigestAlgorithm)"
    #Auth
    - identifier: "Auth(Digest(Domain|(Group)?File|NcCheck|Nonce(Format|Lifetime)|Qop|ShmemSize)|(Group|User)File|LDAP(Authoritative|BindDN|BindPassword|CharsetConfig|CompareDNOnServer|DereferenceAliases|Enabled|FrontPageHack|GroupAttribute|GroupAttributeIsDN|RemoteUserIsDN|Url)|Name|Type)"
    #B
    - identifier: "(BrowserMatch(NoCase)?|BS2000Account|BufferedLogs)"
   #Cache
    - identifier: "Cache(DefaultExpire|Dir(Length|Levels)|Disable|Enable|ExpiryCheck|File|ForceCompletion|Gc(Clean|Daily|Interval|MemUsage|Unused)|Ignore(CacheControl|Headers|NoLastMod)|LastModifiedFactor|MaxExpire|(Max|Min)FileSize|NegotiatedDocs|Root|Size|TimeMargin)"
    #C
    - identifier: "(CGIMapExtension|CharsetDefault|CharsetOptions|CharsetSourceEnc|CheckSpelling|ChildPerUserID|ContentDigest|Cookie(Domain|Expires|Log|Name|Style|Tracking)|CoreDumpDirectory|CustomLog)"
    - identifier: "(Dav|DavDepthInfinity|DavLockDB|DavMinTimeout|DefaultIcon|DefaultLanguage|DefaultType)"
    - identifier: "(DeflateBufferSize|DeflateCompressionLevel|DeflateFilterNote|DeflateMemLevel|DeflateWindowSize|Deny|Directory|DirectoryIndex|DirectoryMatch|DirectorySlash)"
    - identifier: "(DocumentRoot|DumpIOInput|DumpIOOutput|EnableExceptionHook|EnableMMAP|EnableSendfile|ErrorDocument|ErrorLog|Example|ExpiresActive|ExpiresByType)"
    - identifier: "(ExpiresDefault|Ext(endedStatus|Filter(Define|Options))|File(ETag|s(Match)?)|Force(LanguagePriority|Type)|ForensicLog|Group|Header(Name)?)"
    - identifier: "(HostnameLookups|IdentityCheck|IfDefine|IfModule|IfVersion|Imap(Base|Default|Menu)|Include|Index(Ignore|Options|OrderDefault)|ISAPIAppendLogToErrors|ISAPIAppendLogToQuery|ISAPICacheFile|ISAPIFakeAsync|ISAPILogNotSupported|ISAPIReadAheadBuffer|KeepAlive(Timeout)?)"
    - identifier: "(LanguagePriority|LDAP(ConnectionTimeout|(Op)?Cache(Entries|TTL)|SharedCache(File|Size)|TrustedCA(Type)?)|Limit(Except|InternalRecursion|(XML)?RequestBody|Request(Fields|FieldSize|Line))?|Listen(BackLog)?|Load(File|Module)|Location(Match)?|LockFile|Log(Format|Level))"
    #M
    - identifier: "(MaxClients|MaxKeepAliveRequests|MaxMemFree|MaxRequestsPerChild|MaxRequestsPerThread|MaxSpareServers|MaxSpareThreads|MaxThreads|MaxThreadsPerChild|MCacheMaxObjectCount|MCacheMaxObjectSize)"
    - identifier: "(MCacheMaxStreamingBuffer|MCacheMinObjectSize|MCacheRemovalAlgorithm|MCacheSize|MetaDir|MetaFiles|MetaSuffix|MimeMagicFile|MinSpareServers|MinSpareThreads)"
    - identifier: "(MMapFile|ModMimeUsePathInfo|MultiviewsMatch|NameVirtualHost|NoProxy|NumServers|NWSSLTrustedCerts|NWSSLUpgradeable|Options|Order|PassEnv|PidFile|ProtocolEcho)"
    #Proxy
    - identifier: "Proxy(BadHeader|Block|Domain|ErrorOverride|IOBufferSize|Match|MaxForwards|Pass(Reverse)?|PreserveHost|ReceiveBufferSize|Remote(Match)?|Requests|Timeout|Via)"
    - identifier: "(ReadmeName|Redirect(Match|Permanent|Temp)?)"
    - identifier: "Remove(Charset|Encoding|Handler|(Input|Output)Filter|Language|Type)"
    - identifier: "(RequestHeader|Require|Rewrite(Base|Cond|Engine|Lock|Log(Level)?|Map|Options|Rule)|RLimit(CPU|MEM|NPROC))"
    - identifier: "(Satisfy|ScoreBoardFile|Script|ScriptAlias|ScriptAliasMatch|ScriptInterpreterSource|ScriptLog|ScriptLogBuffer|ScriptLogLength|ScriptSock|SecureListen)"
    - identifier: "(SendBufferSize|SetEnv|SetEnvIf|SetEnvIfNoCase|SetHandler)"
    - identifier: "Server(Admin|Alias|Limit|Name|Path|Root|Signature|Tokens)"
    - identifier: "(SetInputFilter|SetOutputFilter|SSIEndTag|SSIErrorMsg|SSIStartTag|SSITimeFormat|SSIUndefinedEcho)"
    # SSL Settings 
    - identifier: "SSL((Proxy)?CA(Certificate|Revocation)(File|Path)|Certificate(Chain|Key)?File|(Proxy)?CipherSuite|(Proxy)?Engine|Mutex|Options|PassPhraseDialog|(Proxy)?Protocol|ProxyMachineCertificate(File|Path)|ProxyVerify(Depth)?|RandomSeed|Require(SSL)?|SessionCache(Timeout)?|UserName|Verify(Client|Depth))"
    - identifier: "(StartServers|StartThreads|SuexecUserGroup|Thread(Limit|PerChild|StackSize)|TimeOut|TraceEnable|TransferLog|TypesConfig|UnsetEnv|UseCanonicalName|User(Dir)?)"
    - identifier: "(VirtualDocumentRoot(IP)?|VirtualHost|VirtualScriptAlias(IP)?|Win32DisableAcceptEx|XBitHack)"
    - symbol.tag: "<[^>]+>"
    - identifier: "</?[A-Za-z]+"
    - identifier: "(<|</|>)"

    - constant.string:
        start: "\""
        end: "\""
        skip: "\\\\."
        rules:
            - constant.specialChar: "\\\\."

    - comment:
        start: "#"
        end: "$"
        rules:
            - todo: "(TODO|XXX|FIXME):?"
