filetype: erb

detect: 
    filename: "\\.erb$|\\.rhtml$"

rules:
    - default:
        start: "%>"
        end: "<%"
        limit-group: preproc
        rules: 
            - include: html
    - red: "&[^;[[:space:]]]*;"
    - statement: "\\b(BEGIN|END|alias|and|begin|break|case|class|def|defined\\?|do|else|elsif|end|ensure|false|for|if|in|module|next|nil|not|or|redo|rescue|retry|return|self|super|then|true|undef|unless|until|when|while|yield)\\b"
    - identifier.var: "(\\$|@|@@)?\\b[A-Z]+[0-9A-Z_a-z]*"
    - magenta: "(?i)([  ]|^):[0-9A-Z_]+\\b"
    - identifier.macro: "\\b(__FILE__|__LINE__)\\b"
    - brightmagenta: "!/([^/]|(\\\\/))*/[iomx]*|%r\\{([^}]|(\\\\}))*\\}[iomx]*"
    - brightblue: "`[^`]*`|%x\\{[^}]*\\}"
    - constant.string: "\"([^\"]|(\\\\\"))*\"|%[QW]?\\{[^}]*\\}|%[QW]?\\([^)]*\\)|%[QW]?<[^>]*>|%[QW]?\\[[^]]*\\]|%[QW]?\\$[^$]*\\$|%[QW]?\\^[^^]*\\^|%[QW]?![^!]*!"
    - brightgreen: "#\\{[^}]*\\}"
    - green: "'([^']|(\\\\'))*'|%[qw]\\{[^}]*\\}|%[qw]\\([^)]*\\)|%[qw]<[^>]*>|%[qw]\\[[^]]*\\]|%[qw]\\$[^$]*\\$|%[qw]\\^[^^]*\\^|%[qw]![^!]*!"
    - comment: "#[^{].*$|#$"
    - comment.bright: "##[^{].*$|##$"
    - identifier.macro:
        start: "<<-?'?EOT'?"
        end: "^EOT"
        rules: []

    - todo: "(XXX|TODO|FIXME|\\?\\?\\?)"
